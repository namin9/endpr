<!doctype html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>GPT-CMS Editor v1</title>
    <link rel="stylesheet" href="styles.css" />
    <link href="https://cdn.jsdelivr.net/npm/quill@1.3.7/dist/quill.snow.css" rel="stylesheet" />
  </head>
  <body>
    <header class="hero">
      <div>
        <p class="eyebrow">Tenant-per-Pages CMS — Editor v1</p>
        <h1>GPT-CMS 편집기</h1>
        <p class="lede">
          게시글 목록, 마크다운 편집기, 자동 저장, 발행/배포 상태까지 한 번에 확인할 수 있는 v1 CMS UI입니다.
          Worker API 호출 구조는 유지하며, UI만 개선했습니다.
        </p>
      </div>
      <div class="actions">
        <button id="printBtn" class="ghost">PDF / Print</button>
      </div>
    </header>

    <main class="app-shell">
      <aside class="panel stack" aria-label="Session and posts">
        <section class="card" aria-labelledby="login-heading">
          <div class="card-header">
            <h2 id="login-heading">로그인</h2>
            <span class="pill">필수</span>
          </div>
          <form id="loginForm" class="stack">
            <label class="field">
              <span>테넌트 슬러그</span>
              <input name="tenant" required placeholder="acme" />
            </label>
            <label class="field">
              <span>이메일</span>
              <input type="email" name="email" required placeholder="editor@acme.com" />
            </label>
            <label class="field">
              <span>비밀번호</span>
              <input type="password" name="password" required placeholder="••••••••" />
            </label>
            <div class="row between">
              <button type="submit" class="primary">로그인</button>
              <button type="button" id="logoutBtn" class="ghost">세션 초기화</button>
            </div>
          </form>
          <div class="session" id="sessionStatus" role="status"></div>
        </section>

        <section class="card" aria-labelledby="posts-heading">
          <div class="card-header">
            <h2 id="posts-heading">게시글 목록</h2>
            <button type="button" id="refreshPostsBtn" class="ghost">새로고침</button>
          </div>
          <div class="posts-toolbar">
            <button type="button" id="newPostBtn" class="primary">새 글</button>
            <div class="posts-toolbar-inputs">
              <input id="postsSearchInput" placeholder="제목 검색" />
              <select id="postsStatusFilter">
                <option value="all">전체</option>
                <option value="draft">draft</option>
                <option value="published">published</option>
              </select>
            </div>
          </div>
          <p id="postsStatus" class="muted">로딩 전</p>
          <div class="posts-table" role="table" aria-label="Posts">
            <div class="posts-row posts-row--head" role="row">
              <div class="posts-cell">제목</div>
              <div class="posts-cell">상태</div>
              <div class="posts-cell">마지막 수정</div>
              <div class="posts-cell">발행일</div>
            </div>
            <div id="postsList" class="posts-body" role="rowgroup"></div>
          </div>
          <div class="posts-pagination">
            <button type="button" id="postsPrevBtn" class="ghost">이전</button>
            <span id="postsPageInfo" class="muted">페이지 1 / 1</span>
            <button type="button" id="postsNextBtn" class="ghost">다음</button>
          </div>
        </section>
      </aside>

      <section class="editor-shell" aria-label="Editor">
        <div class="card editor-card">
          <div class="editor-header">
            <div>
              <h2>에디터</h2>
              <p id="selectedPostMeta" class="muted">선택된 게시글이 없습니다.</p>
            </div>
            <div class="row gap">
              <div class="view-toggle" role="group" aria-label="View mode">
                <button type="button" class="ghost is-active" data-view-mode="split">Split</button>
                <button type="button" class="ghost" data-view-mode="edit">Edit Only</button>
                <button type="button" class="ghost" data-view-mode="preview">Preview Only</button>
              </div>
              <button type="button" id="manualSaveBtn" class="ghost">임시저장</button>
              <button type="button" id="shareLinkBtn" class="ghost">공유 링크 생성</button>
              <button type="button" id="publishBtn" class="primary">발행</button>
              <button type="button" id="viewOnBlogBtn" class="ghost" disabled>View on blog</button>
            </div>
          </div>
          <p id="viewOnBlogHint" class="muted"></p>
          <div id="shareLinkPanel" class="share-panel hidden" aria-live="polite">
            <div class="share-panel__header">
              <strong>Preview/Share 링크</strong>
              <span id="shareLinkExpiry" class="muted"></span>
            </div>
            <div class="share-panel__body">
              <input id="shareLinkInput" readonly />
              <div class="row gap">
                <button type="button" id="copyShareLinkBtn" class="ghost">링크 복사</button>
                <a id="openShareLinkBtn" class="ghost" target="_blank" rel="noopener noreferrer">새 탭에서 열기</a>
              </div>
              <p id="shareLinkMessage" class="muted"></p>
            </div>
          </div>
          <label class="field">
            <span>제목</span>
            <input id="titleInput" placeholder="새 글 제목" />
          </label>
          <div class="editor-split">
            <label class="field editor-pane">
              <span>Editor</span>
              <div id="editorToolbar" class="editor-toolbar ql-toolbar ql-snow">
                <span class="ql-formats">
                  <select class="ql-font"></select>
                  <select class="ql-size"></select>
                </span>
                <span class="ql-formats">
                  <button type="button" class="ql-bold"></button>
                  <button type="button" class="ql-italic"></button>
                  <button type="button" class="ql-underline"></button>
                </span>
                <span class="ql-formats">
                  <select class="ql-color"></select>
                  <select class="ql-background"></select>
                </span>
                <span class="ql-formats">
                  <button type="button" class="ql-align" value=""></button>
                  <button type="button" class="ql-align" value="center"></button>
                  <button type="button" class="ql-align" value="right"></button>
                </span>
                <span class="ql-formats">
                  <button type="button" class="ql-list" value="ordered"></button>
                  <button type="button" class="ql-list" value="bullet"></button>
                  <button type="button" class="ql-blockquote"></button>
                  <button type="button" class="ql-code-block"></button>
                </span>
                <span class="ql-formats">
                  <button type="button" class="ql-link"></button>
                  <button type="button" class="ql-image"></button>
                </span>
              </div>
              <div id="wysiwygEditor" class="wysiwyg-editor"></div>
              <textarea id="bodyInput" class="hidden" rows="18" placeholder="내용을 입력하면 자동 저장됩니다"></textarea>
              <input id="imageUploadInput" class="hidden" type="file" accept="image/*" />
              <div id="uploadPreview" class="upload-preview hidden">
                <div class="upload-preview__header">
                  <span>업로드 미리보기</span>
                  <span id="uploadPreviewCount" class="muted">0건</span>
                </div>
                <p id="uploadStatus" class="muted"></p>
                <div id="uploadPreviewList" class="upload-preview__list"></div>
              </div>
            </label>
            <div class="preview-pane">
              <div class="preview-header">
                <span>미리보기</span>
                <span id="previewStatus" class="muted">실시간</span>
              </div>
              <div class="preview" id="previewPane"></div>
            </div>
          </div>
          <div class="row between">
            <div class="row gap">
              <div id="autosaveStatus" class="muted">대기 중</div>
              <button type="button" id="retrySaveBtn" class="ghost hidden">다시 저장</button>
            </div>
            <button type="button" id="clearDraftBtn" class="ghost">초안 비우기</button>
          </div>
        </div>

        <div class="card" aria-labelledby="publish-heading">
          <div class="card-header">
            <h2 id="publish-heading">발행 & 배포</h2>
            <span class="pill">Deploy Job</span>
          </div>
          <div class="stack">
            <p class="muted">발행 후 배포 상태를 확인하고, BLOG_BASE에 연결된 게시글 링크를 제공합니다.</p>
            <div id="publishMessage" class="muted" role="status"></div>
            <div id="publishLink" class="link-row"></div>
          </div>
        </div>
      </section>

      <aside class="panel stack" aria-label="Deploy jobs">
        <section class="card" aria-labelledby="jobs-heading">
          <div class="card-header">
            <h2 id="jobs-heading">Deploy Job 이력</h2>
            <button type="button" id="refreshJobsBtn" class="ghost">새로고침</button>
          </div>
          <p id="deployJobsScope" class="muted">테넌트 전체 최근 배포 이력</p>
          <div class="job-list" id="deployJobs" aria-live="polite"></div>
        </section>

        <section class="card" aria-labelledby="job-detail-heading">
          <div class="card-header">
            <h2 id="job-detail-heading">Job 상세</h2>
          </div>
          <div id="jobDetail" class="muted">Job을 선택하면 상세가 표시됩니다.</div>
        </section>
      </aside>
    </main>

    <script src="https://cdn.jsdelivr.net/npm/quill@1.3.7/dist/quill.min.js"></script>
    <script src="main.js"></script>
  </body>
</html>
